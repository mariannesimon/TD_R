x2 = pchisq(0.975,n-1)#borne à droite
x1 = pchisq(0.025,n-1)#borne à gauche
#intervalle de confiance:
g = (1/x1)*va*(n-1)
d = (1/x2)*va*(n-1)
g = (1/x2)*va*(n-1)
d = (1/x1)*va*(n-1)
g = va*(n-1)/x2
d = va*(n-1)/x1
rm(list=ls())
n=10
a = c(0.9,10.1,1.9,-0.9,12.6,6.1,6.8,4.0,6.8,-7.3)
b = c(18.0,25.1,1.2,14.6,-3.4,-1.2,24.1,15.5,3.7,5.1)
va = var(a)
vb = var(b)
x2 = pchisq(0.975,n-1)#borne à droite
x1 = pchisq(0.025,n-1)#borne à gauche
g = va*(n-1)/x2
d = va*(n-1)/x1
rap = va/vb
p = qf(n-1,n-1)
rm(list=ls())
n=10
a = c(0.9,10.1,1.9,-0.9,12.6,6.1,6.8,4.0,6.8,-7.3)
b = c(18.0,25.1,1.2,14.6,-3.4,-1.2,24.1,15.5,3.7,5.1)
va = var(a)
vb = var(b)
x2 = qchisq(0.975,n-1)#borne à droite
x1 = qchisq(0.025,n-1)#borne à gauche
g = va*(n-1)/x2
d = va*(n-1)/x1
rap = va/vb
p = qf(n-1,n-1)
rm(list=ls())
n=10
a = c(0.9,10.1,1.9,-0.9,12.6,6.1,6.8,4.0,6.8,-7.3)
b = c(18.0,25.1,1.2,14.6,-3.4,-1.2,24.1,15.5,3.7,5.1)
va = var(a)
vb = var(b)
x2 = qchisq(0.975,n-1)#borne à droite
x1 = qchisq(0.025,n-1)#borne à gauche
g = va*(n-1)/x2
d = va*(n-1)/x1
rap = va/vb
p = 2*pf(va/vb,n-1,n-1)
var.test(a,b)
p = (12+19)/(155+178)
p
rm(list=ls())
k1=12
k2=19
n1=155
n2=178
f1=k1/n1
f2=k2/n2
p = (k1+k2)/(n1+n2)
z=(f2-f1)/(sqrt(p*(1-p)*(1/n1 + 1/n2)))
2*(1-pnorm(z)
print (2*(1-pnorm(z))
2*(1-pnorm(z))
k1=12
k2=19
n1=155
n2=178
f1=k1/n1
f2=k2/n2
p = (k1+k2)/(n1+n2)
z=(f2-f1)/(sqrt(p*(1-p)*(1/n1 + 1/n2)))
2*(1-pnorm(z))
e = (k1-p*n1)^2/(p*n1) +
((n1-k1)-(1-p)*n1)^2/((1-p)*n1 +
(k2-p*n2)^2/(p*n2) +
((n2-k2)-(1-p)*n2)^2/((1-p)*n2
e = (k1-p*n1)^2/(p*n1) +
((n1-k1)-(1-p)*n1)^2/((1-p)*n1 +
(k2-p*n2)^2/(p*n2) +
((n2-k2)-(1-p)*n2)^2/((1-p)*n2
e = (k1-p*n1)^2/(p*n1) + ((n1-k1)-(1-p)*n1)^2/((1-p)*n1 +
(k2-p*n2)^2/(p*n2) +
((n2-k2)-(1-p)*n2)^2/((1-p)*n2
e = (k1-p*n1)^2/(p*n1) +
((n1-k1)-(1-p)*n1)^2/((1-p)*n1 + (k2-p*n2)^2/(p*n2) +
((n2-k2)-(1-p)*n2)^2/((1-p)*n2
e = (k1-p*n1)^2/(p*n1) +
((n1-k1)-(1-p)*n1)^2/((1-p)*n1 + (k2-p*n2)^2/(p*n2) +
((n2-k2)-(1-p)*n2)^2/((1-p)*n2
e
e = (k1-p*n1)^2/(p*n1) +
((n1-k1)-(1-p)*n1)^2/((1-p)*n1) + (k2-p*n2)^2/(p*n2) +
((n2-k2)-(1-p)*n2)^2/((1-p)*n2)
pchisq(0.95,1)
1-pchisq(e,1)
f = 0:5
nb = c(18,56,110,88,40,8)
sd = ((56-2.5)^2+(110*2-2.5)^2+(88*3-2.5)^2+(40*4-2.5)^2+(8*5-2.5)^2)/320
attendu =c()
for (i in 0:5){
attendu += pbinom(i,320,0.5)
}
attendu =c()
for (i in 0:5) attendu += pbinom(i,320,0.5)
attendu =c()
for (i in 0:5) attendu[i] += pbinom(i,320,0.5)
attendu =c()
for (i in 0:5) attendu[i] = pbinom(i,320,0.5)
attendu =c()
for (i in 0:5) attendu[i] = pbinom(i,5,0.5)
attendu =c()
for (i in 0:5) attendu[i] = 320*pbinom(i,5,0.5)
attendu =c()
for (i in 0:5) attendu[i] = pbinom(i,5,0.5)
attendu =c()
for (i in 0:5) attendu[i] = rbinom(i,5,0.5)
y = c(16,26,33,44)
x = c(1.1,1.2,1.3,1.4)
plot(x,y,type="l")
y = c(16,26,33,44)
x = c(1.1,1.2,1.3,1.4)
plot(x,y)
m=mean(y)
rm(list=ls())
rm(list=ls())
y = c(16,26,33,44)
x = c(1.1,1.2,1.3,1.4)
plot(x,y)
b0=mean(y)
xbar=mean(x)
b1=sum((x-xbar)*(y-b0))/sum((x-xbar)^2)
sig=0.5*sum((y-(b0+b1*(x-xbar)))^2)
sig0=sig/sqrt(4)
st=(b0-30)/sig0
1-qt(st,2)
1-pt(st,2)
sig=sqrt(0.5*sum((y-(b0+b1*(x-xbar)))^2))
sig0=sig/sqrt(4)
st=(b0-30)/sig0
1-pt(st,2)
pt(st,2)
2*(1-pt(st,2))
st=(b0-30)/sig0
2*(1-pt(abs(st),2))
g=b0-qt(0.075,2)*sig0
g=b0-qt(0.075,2)*sig0
d=b0+qt(0.075,2)*sig0
g=b0-qt(0.975,2)*sig0
d=b0+qt(0.975,2)*sig0
rm(list=ls())
y = c(16,26,33,44)
x = c(1.1,1.2,1.3,1.4)
plot(x,y)
b0=mean(y)
xbar=mean(x)
b1=sum((x-xbar)*(y-b0))/sum((x-xbar)^2)
sig=sqrt(0.5*sum((y-(b0+b1*(x-xbar)))^2))
sig0=sig/sqrt(4)
st=(b0-30)/sig0
2*(1-pt(abs(st),2))
g=b0-qt(0.975,2)*sig0
d=b0+qt(0.975,2)*sig0
g=b1-qt(0.975,2)*sig0
d=b1+qt(0.975,2)*sig0
sc = sum((b0+b1*(x-xbar)-b0)^2)
g2=b1-qt(0.975,2)*(sig/sqrt(sc))
d2=b2+qt(0.975,2)*(sig/sqrt(sc))
g2=b1-qt(0.975,2)*(sig/sqrt(sc))
d2=b2+qt(0.975,2)*(sig/sqrt(sc))
d2=b1+qt(0.975,2)*(sig/sqrt(sc))
dn = sum((y-b0-b1*(x-xbar))^2)
quo = 2*sc/dn
1 - pf(quo,1,n-2)
1 - pf(quo,1,2)
r2 = sc/(sc-dn)
r2 = sc/(sc+dn)
lm1 = lm(y~x)
lm1
model.matrix(lm1)
lm1 = lm(y~(x-xbar))
lm1
lm1 = lm(y~(x-xbar))
lm1 = lm(y~x)
lm1
predict(lm1)
residuals(lm1)
summary(lm1)
val = -84/6.521
2*(1-pt(abs(val),2))
anova(lm1)
abline(a=b0,b=b1,col="red")
rm(list=ls())
y = c(16,26,33,44)
x = c(1.1,1.2,1.3,1.4)
plot(x,y)
b0=mean(y)
xbar=mean(x)
b1=sum((x-xbar)*(y-b0))/sum((x-xbar)^2)
sig=sqrt(0.5*sum((y-(b0+b1*(x-xbar)))^2))
sig0=sig/sqrt(4)
st=(b0-30)/sig0
2*(1-pt(abs(st),2))
g=b0-qt(0.975,2)*sig0
d=b0+qt(0.975,2)*sig0
sc = sum((b0+b1*(x-xbar)-b0)^2)
dn = sum((y-b0-b1*(x-xbar))^2)
quo = 2*sc/dn
1 - pf(quo,1,2)
r2 = sc/(sc+dn)
lm1 = lm(y~x)
lm1
model.matrix(lm1)
predict(lm1)
residuals(lm1)
summary(lm1)
val = -84/6.521
2*(1-pt(abs(val),2))
anova(lm1)
abline(a=b0,b=b1,col="red")
abline(lm1)
abline(lm1,col="red")
rm(list=ls())
y = c(16,26,33,44)
x = c(1.1,1.2,1.3,1.4)
plot(x,y)
b0=mean(y)
xbar=mean(x)
b1=sum((x-xbar)*(y-b0))/sum((x-xbar)^2)
sig=sqrt(0.5*sum((y-(b0+b1*(x-xbar)))^2))
sig0=sig/sqrt(4)
st=(b0-30)/sig0
2*(1-pt(abs(st),2))
g=b0-qt(0.975,2)*sig0
d=b0+qt(0.975,2)*sig0
sc = sum((b0+b1*(x-xbar)-b0)^2)
dn = sum((y-b0-b1*(x-xbar))^2)
quo = 2*sc/dn
1 - pf(quo,1,2)
r2 = sc/(sc+dn)
lm1 = lm(y~x)
lm1
model.matrix(lm1)
predict(lm1)
residuals(lm1)
summary(lm1)
val = -84/6.521
2*(1-pt(abs(val),2))
anova(lm1)
abline(a=b1,b=b0,col="red")
rm(list=ls())
y = c(16,26,33,44)
x = c(1.1,1.2,1.3,1.4)
plot(x,y)
b0=mean(y)
xbar=mean(x)
b1=sum((x-xbar)*(y-b0))/sum((x-xbar)^2)
sig=sqrt(0.5*sum((y-(b0+b1*(x-xbar)))^2))
sig0=sig/sqrt(4)
st=(b0-30)/sig0
2*(1-pt(abs(st),2))
g=b0-qt(0.975,2)*sig0
d=b0+qt(0.975,2)*sig0
sc = sum((b0+b1*(x-xbar)-b0)^2)
dn = sum((y-b0-b1*(x-xbar))^2)
quo = 2*sc/dn
1 - pf(quo,1,2)
r2 = sc/(sc+dn)
lm1 = lm(y~x)
lm1
model.matrix(lm1)
predict(lm1)
residuals(lm1)
summary(lm1)
val = -84/6.521
2*(1-pt(abs(val),2))
anova(lm1)
abline(lm1,col="red")
cov(x,y)/(var(x)*var(y))
(cov(x,y)/sqrt(var(x)*var(y)))^2
cor.test(x,y)
0.9967554^2
16^5
qbinom(0.95,100,0.4)
qbinom(0.05,100,0.4)
600-342
400-158
Z = 342/600+158/400
p = (342+158)/1000
Z = Z/(sqrt(p*(1-p)*(1/600+1/400)))
2*(1-pnorm(Z))
rm(list=ls())
p=(342+158)/1000
Z=((342/600)+(158/400))/(sqrt(p*(1-p)*(1/600+1/400)))
Z=((342/600)-(158/400))/(sqrt(p*(1-p)*(1/600+1/400)))
2*(1-pnorm(Z))
1-pnorm(Z)
d = read.table("eleves.txt")
d
mu1 = mean(d$V1)
mu2 = mean(d$V2)
s1 = sqrt(29/28*sd(d$V1))
s2 = sqrt(29/28*sd(d$V2))
summary(d$V1<22)
summary(d$V1<26)
summary(d$V1<28)
summary(d$V2<28)
summary(d$V1>28 && d$V1<35)
summary(d$V2<30)
summary(d$V1<30)
summary(d$V1<=28)
summary(d$V2<=28)
summary(d$V2>28 && d$V2<40)
summary(d$V2>28 && d$V2<35)
(d$V2>28 && d$V2<35)
summary(28<d$V2 && d$V2<35)
summary(d$V2<35)
summary(d$V2<=35)
summary(d$V2<=40)
summary(d$V2<=45)
summary(d$V2<=50)
summary(d$V2<=65)
29*(pnorm(28,mu2,s2)-pnorm(0,mu2,s2))
29*(pnorm(28/29,mu2,s2)-pnorm(0,mu2,s2))
s1 = sqrt((29/28)*sd(d$V1))
29*(pnorm(28,mu2,s2)-pnorm(0,mu2,s2))
29*(pnorm(35,mu2,s2)-pnorm(28,mu2,s2))
29*(pnorm(28,mu2,s2)-pnorm(0,mu2,s2))
29*(pnorm(35,mu2,s2)-pnorm(28,mu2,s2))
29*(pnorm(40,mu2,s2)-pnorm(35,mu2,s2))
29*(pnorm(65,mu2,s2)-pnorm(40,mu2,s2))
29*(pnorm(30,mu2,s2)-pnorm(0,mu2,s2))
10+8+12
summary(d$V2<=28)
summary(d$V2<=35)
summary(d$V2<=40)
15+4+8
29*(pnorm(35,mu2,s2)-pnorm(0,mu2,s2))
(12-4)^2/4
(7-15)^2/15
(10-8)^2/8
(29-27)^2/27
16+4.27+0.5+0.148
summary(d$V2<=40)
summary(d$V2<=50)
29*(pnorm(32,mu2,s2)-pnorm(0,mu2,s2))
29*(pnorm(65,mu2,s2)-pnorm(50,mu2,s2))
1-pchisq(20.918,0)
29*(pnorm(35,mu2,s2)-pnorm(32,mu2,s2))
summary(d$V2<=32)
9^2
E=81+16+4.27+0.5+0.148
1-pchisq(E,1)
29*(pnorm(40,mu2,s2)-pnorm(35,mu2,s2))
(7-16)^2/16
E=81+16+5.0625+0.5+0.148
1-pchisq(E,1)
1-pchisq(50,1)
summary(d$V2<=32)
summary(d$V2<=35)
(2-4)^2/4
(7-16)^2/16
E=82+5.06+0.5+0.148
1-pchisq(E,1)
29*(pnorm(32,mu2,s2/sqrt(29))-pnorm(0,mu2,s2/sqrt(29)))
29*(pnorm(35,mu2,s2/sqrt(29))-pnorm(32,mu2,s2/sqrt(29)))
29*(pnorm(35,mu2,s2)-pnorm(32,mu2,s2))
29*(pnorm(40,mu2,s2)-pnorm(35,mu2,s2))
29*(pnorm(32,mu2,s2))
s2^2/s1^2
1-pf(1.276,28,27)
d$V1 = d$V1[1:23] + d$V1[25:29]
c1 = d$V1[1:23] + d$V1[25:29]
d$V.rm(24)
c1 = d$V[1:23]
c1 += d$V[25:29]
c1 = d$V[1:23]
append(c1,d$V1[25:29])
c1
c1 = d$V[1:23]
append(c1,d$V1[25:29])
d$V1[24]=NULL
d$V1[24]=NA
s1 = sqrt((29/28)*sd(d$V1))
s1 = sqrt((28/27)*sd(d$V1))
c=c(47,32,32,20,26,28,39,36,41,40,30,45,28,36,31,22,36,31,34,33,49,35,32,29,22,30,27,41)
s1 = s1 = sqrt((28/27)*sd(c))
s2^2/s1^2
1-pf(1.385,28,27)
s1 = sqrt((28/27)*sd(c))
s2^2/s1^2
s1^2/s2^2
1-pf(0.7216,27,28)
s2^2/s1^2
s1 = sqrt((28/27)*sd(d$V1))
d = read.table("eleves.txt")
d = read.table("eleves.txt")
mu1 = mean(d$V1)
mu2 = mean(d$V2)
s1 = sqrt((28/27)*sd(d$V1))
s2 = sqrt(29/28*sd(d$V2))
s2^2/s1^2
1-pf(1.385,28,27)
1-pf(1.2745,28,27)
d$V1
s1 = sqrt((29/28)*sd(d$V1))
s2^2/s1^2
1-pf(1.2761,28,27)
F=s2^2/s1^2
1-pf(F,28,27)
pf(F,28,27)
1-pf(F,27,28)
s1=(1/28)*sum((d$V1-mu1)^2)
s2=(1/28)*sum((d$V2-mu1)^2)
s2/s1
sqrt(s1)
sqrt(s2)
1-pf(2.13,28,28)
T = (mu2-mu1)/sqrt((s1^2/29)+(s2^2/29))
ddl = ((s1^2/29)+(s2^2/29)^2)/((1/30)*(s1^2/29)^2+(1/30)*(s2^2/29)^2)
2*(1-pt(T,ddl))
t.test(d$V1,d$V2)
T = (mu2-mu1)/sqrt((s1/29)+(s2/29))
ks.test(d$V1,d$V2)
plot(ecdf(d$V1))
plot(ecdf(d$V2),add=T)
n = c(20,50,100,250,500,750,1000)
t = c(0,0.010,0.038,0.239,0.997,2.274,4.126)
plot(n,t)
lm(log(t)~log(n))
lm(log(n)~log(t))
setwd("~/R/TD")
df = read.csv("gopherus.csv")
df
plot(df)
oeufs = df$oeufs
df = read.csv("gopherus.csv",sep=".")
oeufs = df$oeufs
df = read.csv("gopherus.csv",sep";")
oeufs = df$oeufs
df = read.csv("gopherus.csv",sep=";")
oeufs = df$oeufs
df = read.csv("gopherus.csv",sep=";")
oeufs = df$oeufs
long = df$longueur
plot(longeur,oeufs)
plot(long,oeufs)
lm1 = lm(oeufs~long)
summary(lm1)
par(mfrow=c(2,2))
plot(lm1)
long2 = long^2
lm2 = lm(oeufs~long+long2)
summary(lm2)
plot(lm2)
plot(long,oeufs)
lines(lm2)
plot(long2,oeufs)
abline(lm2)
plot(long,oeufs)
curve(-8.892+5.778*x-9.285*x^2,add=T)
plot(long,oeufs)
curve(-8.892+5.778*x-9.285*x^2,add=T)
curve(-8.892+5.778*x-9.285*10^(-3)*x^2,add=T,col="red")
curve(-8.892*10^2+5.778*x-9.285*10^(-3)*x^2,add=T,col="red")
plot(lm2)
par(mfrow=c(2,2))
plot(lm2)
anova(lm2)
lm2 = lm(oeufs~long2+long)
anova(lm2)
cor(long,long2)
lm3 = lm(long2~long)
# pour recuperer la part de residus liee a la partie quadratique
anova(lm3)
long2bis = residuals(lm(long2~long))
lm3 = lm(oeufs~long+long2bis)
summary(lm3)
plot(lm3)
long2bis = residuals(lm(long2~long))
lm3 = lm(oeufs~long+long2bis)
summary(lm3)
predict(lm2)
predict(lm3)
anova(lm2,lm3)
shapiro.test(residuals(lm3))
cor(long2,long2bis)
anova(lm2)
anova(lm3)
anova(lm3,lm1)
lm4 = lm(oeufs~poly(long,2))
summary(lm4)
predict(lm4)
lm5 = lm(oeufs~poly(long,3))
summary(lm5)
rm(list=ls())
df = read.table("aspirine_formate.txt",h=T)
boxplot(df$activite~df$mol)
contrasts(fmol2) = contr.treatment(5,base=2)
fmol2=fmol
fmol = factor(df$mol) #remplacer une variable qualitative par une variable quantitative
fmol2=fmol
contrasts(fmol2) = contr.treatment(5,base=2)
lm2 = lm(df$activite~fmol2)
summary(lm2)
p = summary(lm1)$coefficients[2:5,4]
p.adjust(p,method="bonferroni")
p = summary(lm2)$coefficients[2:5,4]
p.adjust(p,method="bonferroni")
lm2
install.packages("multcomp")
library(multcomp)
lm2d = glht(lm2, c('fmol21=0','fmol23=0','fmol24=0','fmol25=0'))
summary(lm2d)
p.adjust(p,method="holm")
p.adjust(p,method="bonferroni")
